<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · WENDy.jl</title><meta name="title" content="Getting Started · WENDy.jl"/><meta property="og:title" content="Getting Started · WENDy.jl"/><meta property="twitter:title" content="Getting Started · WENDy.jl"/><meta name="description" content="Documentation for WENDy.jl."/><meta property="og:description" content="Documentation for WENDy.jl."/><meta property="twitter:description" content="Documentation for WENDy.jl."/><meta property="og:url" content="https://nrummel.github.io/WENDy.jl/gettingStarted/"/><meta property="twitter:url" content="https://nrummel.github.io/WENDy.jl/gettingStarted/"/><link rel="canonical" href="https://nrummel.github.io/WENDy.jl/gettingStarted/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WENDy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Test-Function-Selection"><span>Test Function Selection</span></a></li><li><a class="tocitem" href="#Optimization-Parameters"><span>Optimization Parameters</span></a></li><li><a class="tocitem" href="#Solver-Selection"><span>Solver Selection</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nrummel/WENDy.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><p>The first step to using WENDy.jl is to build the <a href="../reference/#WENDy.WENDyProblem">WENDyProblem</a> struct. The constructor will precompute all the necessary data and prepare all the necessary functions to run different optimizers to estimate the unknown parameters <span>$p$</span>. The algorithm only requires a few inputs </p><ul><li><code>tt</code> : vector of equispaced times <span>$\{t_m\}_{m=0}^M$</span>.</li><li><code>U</code> : data matrix where each row is a state vector at each time <span>$\{\mathbf{u}_m = \boldsymbol{u}(t_m) + \epsilon_m\}_{m=0}^M$</span>. This makes the size of this matrix <span>$M+1\times D$</span>. </li><li><code>f!</code> : right hand side function for the ordinary system of equations of the form <code>f!(du, u, p, t)</code></li><li><code>J</code> : An integer specifying the length of the unknown parameters vector <span>$p$</span>.</li></ul><pre><code class="language-julia hljs">wendyProb = WENDyProblem(tt, U, f!, J)</code></pre><p>It is important to note that there are optional inputs that are keyword arguments that can help get the best performance from the algorithm. </p><ul><li><code>linearInParameters</code> : (Default <code>Val(false)</code>) If the ODE is linear in parameters (lip) then one can accelerate our weak form algorithms by setting this to <code>Val(true)</code>. This allows the WENDyProblem to be specified as lip at compile time. Specifying special routines that will make many function evaluations and the following optimization faster. </li><li><code>noiseDist</code> : (Default <code>Val(Normal)</code>) This specifies whether the noise is additive Gaussian <code>Val(Normal)</code> or multiplicative LogNormal <code>Val(LogNormal)</code>. Again this flag allows the correct subroutines to be specified at compile time. </li><li><code>params</code> : (Default <code>WENDyParameters()</code>)One can update the hyper-parameters for WENDy via the <a href="../reference/#WENDy.WENDyParameters">WENDyParameters</a> struct. Of particular interest are the parameters that inform the test function selection algorithm (see <a href="#Test-Function-Selection">Test Function Selection</a>) and those that that inform the optimization algorithms (see <a href="#Optimization-Parameters">Optimization Parameters</a>)</li><li><code>constraints</code> : (Default <code>Nothing</code>) WENDy supports linear box constraints for each parameter, ∀j ∈ [1, ⋯,J], ℓⱼ ≤ pⱼ ≤ uⱼ. Accepts constraints as a list of tuples, [(ℓ₁,u₁), ⋯]. Note: this only is compatible with the TrustRegion solver.</li><li><code>ll</code> : (Default <code>Warn</code>) Logging level </li></ul><p>The next step is to solve the WENDy problem. This is done by calling the <a href="../reference/#WENDy.solve">solve</a> function. An initial guess for the parameters, <span>$p_0$</span>, is necessary for the local optimization routines to run. It may be necessary to run the WENDy algorithm with multiple initial guesses for best results. </p><pre><code class="language-julia hljs">solve(wendyProb, p₀)</code></pre><h2 id="Test-Function-Selection"><a class="docs-heading-anchor" href="#Test-Function-Selection">Test Function Selection</a><a id="Test-Function-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Test-Function-Selection" title="Permalink"></a></h2><p>WENDy works by moving the system of equation into its <a href="https://en.wikipedia.org/wiki/Weak_formulation">weak form</a>. For this purpose, we select test functions that are bump functions of the form:</p><p class="math-container">\[	\varphi(t ; a)=C \exp \left(-\frac{\eta}{\left[1-(\tfrac{t}{m_t\Delta t} )^2\right]_{+}}\right)\]</p><p>where <span>$m_t$</span> can be thought of as the radius of the support, the constant <span>$C$</span> normalizes the test function such that <span>$\|\varphi\|_2=1$</span>, and <span>$\eta$</span> is a shape parameter, and <span>$[\cdot]_{+} = \max (\cdot, 0)$</span>, so that <span>$\varphi(t ; m_t\Delta t)$</span> is supported only on <span>$[-m_t\Delta t, m_t\Delta t]$</span>.</p><p>WENDy.jl attempts to automatically select multiple test functions with radii that balance preserving information while minimizing the effects due to noise. One may want to adjust the following in the <code>WENDyParameters</code>:</p><ul><li><code>Kmax</code> - maximum number of test functions allow. This is a hard threshold, and may be aggressive in some cases. Set the Logging Level <code>ll</code> in the <code>WENDyProblem</code> constructor to <code>Info</code>. If the information lost in the SVD reduction gets below 50% then an adjustment may be necessary. In most cases, the radii of the test functions is more likely cause of poor results. </li><li><code>radiusMinTime</code> which is a lower bound on the smallest <span>$m_t$</span> considered by WENDy. This parameters has the same units as the <code>tt</code> passed when building a <code>WENDyProblem</code>. </li><li><code>radiusMaxTime</code>which is a upper bound on the smallest <span>$m_t$</span> considered by WENDy. This parameters has the same units as the <code>tt</code> passed when building a <code>WENDyProblem</code>. </li></ul><p>A good idea is to visualize the data yourself, and see how quickly the state variable is changing. It is ok to give WENDy a large range for the test function radii, but some adjustment may be necessary to get the best results. </p><p>The other test function parameters really get into the weeds of the this sub algorithm and in most cases are best left alone. </p><h2 id="Optimization-Parameters"><a class="docs-heading-anchor" href="#Optimization-Parameters">Optimization Parameters</a><a id="Optimization-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-Parameters" title="Permalink"></a></h2><p>WENDy makes use of several different optimization routines. For the default solver, one may want to adjust the following in the <code>WENDyParameters</code> for runtime or accuracy:</p><ul><li><code>optimAbstol</code> : (Default 1e-8) Absolute Error Tolerance</li><li><code>optimReltol</code> : (Default 1e-8) Relative Error Tolerance</li><li><code>optimMaxiters</code> : (Default 500) Maximum Number of Iterations</li><li><code>optimTimelimit</code> : (Default 200.0) Time limit in seconds</li></ul><h2 id="Solver-Selection"><a class="docs-heading-anchor" href="#Solver-Selection">Solver Selection</a><a id="Solver-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Solver-Selection" title="Permalink"></a></h2><p>WENDy.jl allows for the user to make use of several different solvers. This is done through the keyword argument <code>solve(wendyProblem, p₀ ; solver = ...)</code> in the <code>solve</code> . </p><ul><li>For the maximum likelihood estimator one should select either:<ul><li><code>TrustRegion()</code> : (Default) Allows for both constrained and unconstrained problems</li><li><code>ARCqK()</code> : Only for the unconstrained, but may lead to a different solution</li></ul></li><li><code>OELS()</code> : A common technique is to minimize the output error. WENDy.jl provides a simple forward solve least squares solver for comparison. </li><li><code>IRLS()</code> : This is (in general) a more computationally efficient solver that still incorporates covariance information from the weak form residual, but frames a generalized least squares problem instead of a maximum likelihood estimator. </li><li><code>WLS()</code> : This simple minimizes the norm of the weak form residual by posing either linear or nonlinear least squares problem. This is the most appropriate if there is no noise in the system. </li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 9 February 2025 15:15">Sunday 9 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
